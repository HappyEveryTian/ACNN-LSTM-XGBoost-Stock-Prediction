# 基于注意力机制的CNN-LSTM和XGBoost混合模型预测分析-股票预测

## Requirements

代码在Python3.7.4版本下运行，以下是各个依赖版本：
```
numpy==1.21.6
sklearn==0.21.3
statsmodels==0.10.1
pandas==1.2.1
tensorflow==2.1.0
keras==2.3.1
xgboost==1.5.0
matplotlib==3.5.3
tushare==1.4.19
```
你也可以根据requirements.txt进行快速安装。

## 模型预测
目前模型预测分析如下：

| 00003.HK |  ARIMA  |  LSTM   | ARIMA-LSTM | XGBoost | CNN-LSTM | CNN-LSTM-XGBoost | CNN-LSTM-Attention | CNN-LSTM-Attention-XGBoost |
|:--------:|:-------:|:-------:|:----------:|:-------:|:--------:|:----------------:|:------------------:|:--------------------------:|
|   MSE    | 0.00618 | 0.00933 |  0.00001   | 0.00676 | 0.01947  |     0.00560      |      0.02502       |          0.00560           |
|   RMSE   | 0.07863 | 0.09661 |  0.00272   | 0.08224 | 0.13953  |     0.07486      |      0.15819       |          0.07486           |
|   MAE    | 0.06016 | 0.05990 |  0.00211   | 0.06313 | 0.12049  |     0.05650      |      0.13811       |          0.05650           |
|    R2    | 0.93696 | 0.90753 |  0.99992   | 0.93104 | 0.61327  |     0.93840      |      0.50292       |          0.93840           |

| 601988.SH |   ARIMA   |   LSTM   | ARIMA-LSTM | XGBoost | CNN-LSTM | CNN-LSTM-XGBoost | CNN-LSTM-Attention | CNN-LSTM-Attention-XGBoost |
|:---------:|:---------:|:--------:|:----------:|:-------:|:--------:|:----------------:|:------------------:|:--------------------------:|
|    MSE    |  0.00027  | 0.00026  |  0.00027   | 0.00028 | 0.00943  |     0.00020      |      0.01065       |          0.00020           |
|   RMSE    |  0.01637  | 0.01611  |  0.01637   | 0.01687 | 0.09710  |     0.01430      |      0.10319       |          0.01430           |
|    MAE    |  0.01190  | 0.01181  |  0.01190   | 0.01193 | 0.07227  |     0.01116      |      0.08083       |          0.01116           |
|    R2     |  0.84374  | 0.81784  |  0.84304   | 0.83411 | 0.76241  |     0.89297      |      0.73166       |          0.89297           |