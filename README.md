# 基于注意力机制的CNN-LSTM和XGBoost混合模型预测分析-股票预测

## Requirements

代码在Python3.7.4版本下运行，以下是各个依赖版本：
```
numpy==1.21.6
sklearn==0.21.3
statsmodels==0.10.1
pandas==1.2.1
tensorflow==2.1.0
keras==2.3.1
xgboost==1.5.0
matplotlib==3.5.3
tushare==1.4.19
```
你也可以根据requirements.txt进行快速安装。

## 模型预测
目前模型预测分析如下：

| 01810.HK |  ARIMA  |  LSTM   | ARIMA-LSTM | XGBoost | CNN-LSTM | CNN-LSTM-XGBoost | CNN-LSTM-Attention | CNN-LSTM-Attention-XGBoost |
|:--------:|:-------:|:-------:|:----------:|:-------:|:--------:|:----------------:|:------------------:|:--------------------------:|
|   MSE    | 1.55472 | 1.55472 |  2.42545   | 1.92484 | 0.00776  |     1.80670      |      0.00731       |          1.80670           |
|   RMSE   | 1.24688 | 1.24688 |  1.55738   | 1.38739 | 0.08811  |     1.34414      |      0.08547       |          1.34414           |
|   MAE    | 0.92616 | 0.92616 |  1.16782   | 0.98570 | 0.06579  |     0.92142      |      0.06343       |          0.92142           |
|    R2    | 0.97819 | 0.97718 |  0.96222   | 0.97300 | 0.89581  |     0.97198      |      0.90197       |          0.97198           |

| 601988.SH |   ARIMA   |   LSTM   | ARIMA-LSTM | XGBoost | CNN-LSTM | CNN-LSTM-XGBoost | CNN-LSTM-Attention | CNN-LSTM-Attention-XGBoost |
|:---------:|:---------:|:--------:|:----------:|:-------:|:--------:|:----------------:|:------------------:|:--------------------------:|
|    MSE    |  0.00027  | 0.00026  |  0.00027   | 0.00028 | 0.00943  |     0.00020      |      0.01065       |          0.00020           |
|   RMSE    |  0.01637  | 0.01611  |  0.01637   | 0.01687 | 0.09710  |     0.01430      |      0.10319       |          0.01430           |
|    MAE    |  0.01190  | 0.01181  |  0.01190   | 0.01193 | 0.07227  |     0.01116      |      0.08083       |          0.01116           |
|    R2     |  0.84374  | 0.81784  |  0.84304   | 0.83411 | 0.76241  |     0.89297      |      0.73166       |          0.89297           |